<!DOCTYPE html>
<html lang="da" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AF Phone</title>

    <link rel="stylesheet" media="all" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" media="all" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" media="all" type="text/css" href="https://unpkg.com/tippy.js@6/animations/scale.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" media="all" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/tippy.js/6.3.7/animations/scale.min.css" integrity="sha512-MmJrbMCEMWdj/tp1ze1tpJb/BOdCJcIA0Oe5Cu5gm5Hmc7aKy3eKc+64Ce/cr2PSFOwXlcErGV0THg8LT/FORg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" media="all" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/tippy.js/6.3.7/tippy.min.css" integrity="sha512-HbPh+j4V7pXprvQMt2dtmK/zCEsUeZWYXRln4sOwmoyHPQAPqy/k9lIquKUyKNpNbDGAY06UdiDHcEkBc72yCQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
 
    <link rel="stylesheet" media="all" type="text/css" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <link rel="stylesheet" media="all" type="text/css" href="css/main.css">
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tippy.js/6.3.7/tippy.umd.min.js" integrity="sha512-2TtfktSlvvPzopzBA49C+MX6sdc7ykHGbBQUTH8Vk78YpkXVD5r6vrNU+nOmhhl1MyTWdVfxXdZfyFsvBvOllw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://unpkg.com/tippy.js@6" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <!-- JQuery -->
    <script type="text/javascript" src="https://code.jquery.com/ui/1.13.2/jquery-ui.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="https://kit.fontawesome.com/48c8cc3987.js" crossorigin="anonymous"></script>
</head>
<body>
    <div id="app" current-time="00:00">
        <div class="position" style="height: 1211px; width: 624.57px; right: 3.39749rem; bottom: 1.875rem;">
            <div class="phone show">
                <div class="phone-cover">
                    <div class="phone-container">
                        <img class="phone-baggrund" src="https://arcticfireline.com/assets/files/img/gta/wallpaper.webp" alt="">
                        <div class="phone-notification">
                            <div class="notification-content">
                                <div class="icon"><i class="bi bi-discord"></i></div>
                                <div class="text overflow-hidden">
                                    <div class="d-flex justify-content-between gap-1">
                                        <div class="fw-medium text-truncate">Discord</div>
                                        <div class="fw-light text-muted text-nowrap">2m s.</div>
                                    </div>
                                    <p class="text-muted">Du har modtaget en venneanmodning fra RedEye</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="phone-header">
                            <div class="header-content">
                                <p style="font-size: 5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);font-weight: 500;" time>23:30</p>
                            </div>
                            <div class="header-content">
                                <i style="font-size: 3cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);" class="bi bi-circle-fill d-flex"></i>
                            </div>
                            <div class="header-content">
                                <i style="font-size: 5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);" class="bi bi-wifi d-flex"></i>
                                <i style="font-size: 5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);" class="bi bi-battery-full d-flex"></i>
                            </div>
                        </div>
                        <div class="phone-lockscreen">
                            <img class="phone-baggrund" src="https://arcticfireline.com/assets/files/img/gta/wallpaper.webp" alt="">
                            <div class="">
                                <p class="text-center lh-1">
                                    <span style="font-size: 6cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);">fre. 29.</span>
                                    <span style="font-size: 6cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);">vejr</span>
                                </p>
                                <p class="text-center lh-1" style="font-size: 25cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);" time>21.00</p>
                            </div>
                            <div class="d-flex justify-content-between mt-auto px-2">
                                <div class="bg-black d-flex align-items-center justify-content-center rounded-circle bg-opacity-50 cursor-pointer" style="width: 13cqw; height: 13cqw;">
                                    <img width="100%" style="width: 6cqw; height: 6cqw; object-fit: contain;filter: invert(1);" src="./images/flashlight.png">
                                </div>
                                <div class="bg-black d-flex align-items-center justify-content-center rounded-circle bg-opacity-50 cursor-pointer" style="width: 13cqw; height: 13cqw;">
                                    <img width="100%" style="width: 6cqw; height: 6cqw; object-fit: contain;filter: invert(1);" src="./images/camera.webp">
                                </div>
                            </div>
                        </div>
                        <div class="phone-content closed">
                            <div class="app-start">
                                <div class="start-standard d-flex flex-wrap p-2 pt-2" apps>
                                    <div class="w-25 h-25 text-center">
                                        <div class="app" id="settings" style="margin: 0 1cqw 3cqw 1cqw;">
                                            <span class="edit-mode position-absolute p-2 bg-secondary rounded-circle shadow border border-light border-opacity-25" style="top: -3cqw;left: 0;width: 6cqw;height: 6cqw;display:flex;align-items: center;justify-content: center;">
                                                <span style="font-size: 6cqw;">-</span>
                                            </span>
                                            <img src="./images/apps/settings.webp" draggable="false" width="100%" style="height: 15cqw;width: 15cqw;border-radius: 3.8cqw;box-shadow:0 0 15px 0px rgba(0, 0, 0, 25%);">
                                            <p class="mt-0 text-truncate" style="font-size: 3.5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);">Settings</p>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 p-2 text-center">
                                        <div class="bg-primary rounded-3 p-2">
                                            <i class="bi bi-discord fs-4 d-flex justify-content-center"></i>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 p-1 text-center">
                                        <div class="bg-primary rounded-3 p-2">
                                            <i class="bi bi-discord fs-4 d-flex justify-content-center"></i>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 p-1 text-center">
                                        <div class="bg-primary rounded-3 p-2">
                                            <i class="bi bi-discord fs-4 d-flex justify-content-center"></i>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 p-1 text-center">
                                        <div class="bg-primary rounded-3 p-2">
                                            <i class="bi bi-discord fs-4 d-flex justify-content-center"></i>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 p-1 text-center">
                                        <div class="bg-primary rounded-3 p-2">
                                            <i class="bi bi-discord fs-4 d-flex justify-content-center"></i>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 p-1 text-center">
                                        <div class="bg-primary rounded-3 p-2">
                                            <i class="bi bi-discord fs-4 d-flex justify-content-center"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="start-navigation d-flex flex-wrap align-items-center justify-content-center">
                                    <div class="navigation-content">
                                        <div class="dots active"></div>
                                        <div class="dots"></div>
                                        <div class="dots"></div>
                                    </div>
                                </div>
                                <div class="start-primary d-flex flex-wrap p-1 pt-2 m-2 bg-secondary bg-opacity-75 rounded-4 mt-auto" primary-apps>
                                    <div class="w-25 h-25 text-center">
                                        <div class="app" id="tinder" style="margin: 0 1cqw 0 1cqw;">
                                            <span class="edit-mode position-absolute p-2 bg-secondary rounded-circle shadow border border-light border-opacity-25" style="top: -3cqw;left: 0;width: 6cqw;height: 6cqw;display:flex;align-items: center;justify-content: center;">
                                                <span style="font-size: 6cqw;">-</span>
                                            </span>
                                            <img src="./images/apps/tinder.png" draggable="false" width="100%" style="height: 15cqw;width: 15cqw;border-radius: 3.8cqw;box-shadow:0 0 15px 0px rgba(0, 0, 0, 25%);">
                                            <p class="mt-0 text-truncate" style="font-size: 3.5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);">Tinder</p>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 text-center">
                                        <div class="app" id="discord" style="margin: 0 1cqw 0 1cqw;">
                                            <span class="edit-mode position-absolute p-2 bg-secondary rounded-circle shadow border border-light border-opacity-25" style="top: -3cqw;left: 0;width: 6cqw;height: 6cqw;display:flex;align-items: center;justify-content: center;">
                                                <span style="font-size: 6cqw;">-</span>
                                            </span>
                                            <img src="./images/apps/discord.png" draggable="false" width="100%" style="height: 15cqw;width: 15cqw;border-radius: 3.8cqw;box-shadow:0 0 15px 0px rgba(0, 0, 0, 25%);">
                                            <p class="mt-0 text-truncate" style="font-size: 3.5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);">Discord</p>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 text-center">
                                        <div class="app" id="spotify" style="margin: 0 1cqw 0 1cqw;">
                                            <span class="edit-mode position-absolute p-2 bg-secondary rounded-circle shadow border border-light border-opacity-25" style="top: -3cqw;left: 0;width: 6cqw;height: 6cqw;display:flex;align-items: center;justify-content: center;">
                                                <span style="font-size: 6cqw;">-</span>
                                            </span>
                                            <img src="./images/apps/spotify.png" draggable="false" width="100%" style="height: 15cqw;width: 15cqw;border-radius: 3.8cqw;box-shadow:0 0 15px 0px rgba(0, 0, 0, 25%);">
                                            <p class="mt-0 text-truncate" style="font-size: 3.5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);">Spotify</p>
                                        </div>
                                    </div>
                                    <div class="w-25 h-25 text-center">
                                        <div class="app" id="mail" style="margin: 0 1cqw 0 1cqw;">
                                            <span class="edit-mode position-absolute p-2 bg-secondary rounded-circle shadow border border-light border-opacity-25" style="top: -3cqw;left: 0;width: 6cqw;height: 6cqw;display:flex;align-items: center;justify-content: center;">
                                                <span style="font-size: 6cqw;">-</span>
                                            </span>
                                            <img src="./images/apps/mail.webp" draggable="false" width="100%" style="height: 15cqw;width: 15cqw;border-radius: 3.8cqw;box-shadow:0 0 15px 0px rgba(0, 0, 0, 25%);">
                                            <p class="mt-0 text-truncate" style="font-size: 3.5cqw;text-shadow: 0 0 3px rgba(0, 0, 0, 25%);">Mail</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="app-content" id="settings-page">
                                
                            </div>
                        </div>
                        <div class="phone-home-footer">
                            <div class="phone-home"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/main.js"></script>
    <script src="js/Sortable.js"></script>
    <script>
        $(function() {
            let startY;
            let initialBottom = 0;
            let isEditable = isMoveable = isSwiping = hasMouseUp = false;
            let interval = 0;
            let moveSortable1;
            let moveSortable2;
            let intervalId;

            const phoneContainerHeight = $(".phone-container").outerHeight();
            const phoneLockscreenHeight = $(".phone-lockscreen").outerHeight();

            appsEditable = (elm) => {
                isEditable = true;
                interval = 0;

                console.log("editable", elm)

                elm.addClass('editable');
                $('<div class="app-backdrop"></div>').insertBefore(elm);
                $('.app-backdrop').on('click', function() {
                    $('.app-backdrop').remove();
                    elm.removeClass('editable');
                    interval = 0;
                    isEditable = false;
                    hasMouseUp = false;
                    clearInterval(intervalId);
                });
            }

            appsMoveable = (sortElm) => {
                isMoveable = true;
                interval = 0;
                console.log("apps i moveactive")
                $('.app').addClass('shake');
                moveSortable1 = new Sortable($('[apps]')[0], {
                    group: 'shared',
                    swapThreshold: 1,
                    animation: 150,
                    onChange: function(event, ui) {
                        console.log('onChange')
                    },
                    onUpdate: function(event, ui) {
                        console.log('onUpdate')
                        // var type = (event.from.getAttribute('data-type') ? event.from.getAttribute('data-type') : '');
                        // var url = (event.from.getAttribute('data-url') ? event.from.getAttribute('data-url') : '');
                        
                        // var data = Array.from($(this.el).find('.task.active')).map((element, key) => {
                        //     var content = $(element).find('.task-counter').attr('data-tippy-content');
                        //     $(element).find('.task-counter').attr('data-tippy-content', content.replace(content.match(/\d+/)[0], (key + 1)));
                        //     return element.getAttribute('data-id');
                        // });
                
                        // request(`${URL}/assets/lib/sortable/sortable`, 'POST', {type: type, data: data}).then((result) => {
                        //     if (url.length > 0) {
                        //         // window.location = url;
                        //     }
                        //     console.log(result);
                        // });
                        // initializeTippy();
                    }
                });
                moveSortable2 = new Sortable($('[primary-apps]')[0], {
                    group: 'shared',
                    swapThreshold: 1,
                    animation: 150
                });
                setTimeout(() => {
                    $('.app').each(function(index, elm) {
                        const delay = index * 100;
                        $(this).css('animation-delay', `${delay}ms`);
                    });
                }, 500);
            }

            $(document).on('touchstart mousedown', '.phone.show .app-start', function(event) {
                console.log('is making apps active')

                if ($(event.target).closest('.app').length == 0) {
                    if (moveSortable1 instanceof Sortable) moveSortable1.destroy(); moveSortable1 = null;
                    if (moveSortable2 instanceof Sortable) moveSortable2.destroy(); moveSortable2 = null;
                    $('.app').removeClass('shake');
                    interval = 0;
                    isMoveable = false;
                    clearInterval(intervalId);
                    if (!isEditable) {
                        interval = 0;
                        intervalId = setInterval(function() {
                            interval += 1;
                            if (interval >= 100) {
                                clearInterval(intervalId);
    
                                event.preventDefault();
                                appsMoveable();
                            }
                        }, 1);
                    }
                } else {
                    $('.app-backdrop').remove();
                    $('.app').removeClass('editable');
                    interval = 0;
                    isEditable = false;
                    clearInterval(intervalId);
                    if (!isMoveable) {
                        interval = 0;
                        intervalId = setInterval(function() {
                            interval += 1;
                            if (interval >= 100) {
                                clearInterval(intervalId);

                                event.preventDefault();
                                appsEditable($(event.target).closest('.app'));
                            }
                        }, 1);
                    }
                }
            });

            $(document).on('touchmove mousemove', function(event) {
                if (isEditable && !isMoveable && !hasMouseUp) {
                    if ($(event.target).closest('.app').length == 0) {
                        event.preventDefault();
                        console.log("ude")

                        $('.app-backdrop').remove();
                        $('.app').removeClass('editable');
                        isEditable = false;
                        appsMoveable($('.app.editable'));
                    }
                }

                if (isSwiping && !$('.position').hasClass('active')) {
                    let currentY;
                    if (event.type === 'touchmove') {
                        currentY = event.touches[0].clientY;
                    } else {
                        currentY = event.clientY;
                    }

                    let deltaY = startY - currentY;

                    initialBottom += deltaY;

                    initialBottom = Math.max(0, initialBottom);
                    initialBottom = Math.min(phoneContainerHeight, initialBottom); 
                    
                    let blurIntensity = Math.min(10, (initialBottom / (phoneContainerHeight / 3)) * 2);

                    $('.phone-lockscreen .phone-baggrund').css('filter', 'blur(' + blurIntensity + 'px)');
                    $('.phone-lockscreen, .phone-home-footer').css('bottom', initialBottom + 'px');

                    startY = currentY;
                }
            });

            $(document).on('touchend mouseup', function(event) {
                if (isEditable) {
                    hasMouseUp = true;
                }
                clearInterval(intervalId);

                if (isSwiping && !$('.position').hasClass('active')) {
                    if (initialBottom >= phoneContainerHeight / 2) {
                        $('.phone-lockscreen').animate({ bottom: phoneContainerHeight + 'px', opacity: 0, display: 'none' }, 300);
                        $('.phone-home-footer').css({bottom: '0px', opacity: '0'});
                        $('.phone-home-footer').animate({opacity: '1'});
                        $('.phone-lockscreen').addClass('open');
                        $('.phone-home-footer').addClass('home');
                        $('.phone-content').removeClass('closed');
                    } else {
                        $('.phone-lockscreen, .phone-home-footer').animate({ bottom: '0px' }, 300);
                    }

                    $('.phone-lockscreen').css('filter', 'none');
                    initialBottom = 0;
                    isSwiping = false;
                }
            });

            $(document).on('touchstart mousedown', '.position:not(.active) .phone-home-footer:not(.home)', function(event) {
                console.log('is swiping')
                isSwiping = true;
                if (event.type === 'touchstart') {
                    startY = event.touches[0].clientY;
                } else {
                    startY = event.clientY;
                }
            });

            $(document).on('click', '.app', function(event) {
                if (!isEditable && !isMoveable) {
                    var $target = $(this);
                    $(`.app-content`).removeClass('active');
                    $(`#${$($target).attr('id')}-page`).addClass('active');
                    setTimeout(() => {
                        $('body').addClass(`${$($target).attr('mode')}-mode`);
                    }, 250);
                }
            });

            $(document).on('click', '.phone-home-footer.home', function() {
                $('.phone-home-footer').css("transition", "transform 0.3s").css("transform", "scale(1)");
                if (!isSwiping) {
                    $('.app-content').removeClass('active');
                    $('body').removeClass('light-mode');
                }
            });

            var height = 475;
            var width = 245;

            $('.position.active').resizable({
                handles: 'all',
                containment: 'parent',
                minHeight: 475,
                minWidth: 245,
                aspectRatio: true,
                ghost: true,
                classes: {
                    'ui-resizable-se': 'ui-icon ui-icon-gripsmall-diagonal-se rotate-0',
                    'ui-resizable-sw': 'ui-icon ui-icon-gripsmall-diagonal-se rotate-90',
                    'ui-resizable-nw': 'ui-icon ui-icon-gripsmall-diagonal-se rotate-180',
                    'ui-resizable-ne': 'ui-icon ui-icon-gripsmall-diagonal-se rotate-270',
                },
                stop: function(event, ui) {                    
                    const fontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
                    const parentWidth = $(this).parent().width();
                    const parentHeight = $(this).parent().height();
                    const rightRem = (parentWidth - ui.position.left - ui.helper.width()) / fontSize;
                    const bottomRem = (parentHeight - ui.position.top - ui.helper.height()) / fontSize;

                    height = ui.size.height;
                    width = ui.size.width;

                    $(this).attr('style', null);
                    $(this).css({
                        'height': height + 'px',
                        'width': width + 'px',
                        'right': rightRem + 'rem',
                        'bottom': bottomRem + 'rem',
                    });
                }
            });

            $('.position.active').draggable({
                containment: 'parent',
                stop: function(event, ui) {
                    const fontSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
                    const parentWidth = $(this).parent().width();
                    const parentHeight = $(this).parent().height();
                    const rightRem = (parentWidth - ui.position.left - ui.helper.width()) / fontSize;
                    const bottomRem = (parentHeight - ui.position.top - ui.helper.height()) / fontSize;

                    $(this).attr('style', null);
                    $(this).css({
                        'height': height + 'px',
                        'width': width + 'px',
                        'right': rightRem + 'rem',
                        'bottom': bottomRem + 'rem',
                    });
                }
            });
        });
    </script>
</body>
</html>